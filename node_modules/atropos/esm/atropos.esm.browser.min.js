/**
 * Atropos 1.0.2
 * Touch-friendly 3D parallax hover effects
 * https://atroposjs.com
 *
 * Copyright 2021-2022 
 *
 * Released under the MIT License
 *
 * Released on: February 17, 2022
 */

function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var $=function(t,e){return t.querySelector(e)},$$=function(t,e){return t.querySelectorAll(e)},removeUndefinedProps=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(o){void 0!==t[o]&&(e[o]=t[o])})),e};function Atropos(t){void 0===t&&(t={});var e,o,a,n,r,i,s,p,c,u,d,l=t,f=l.el,v=l.eventsEl,h={__atropos__:!0,params:_extends({alwaysActive:!1,activeOffset:50,shadowOffset:50,shadowScale:1,duration:300,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,stretchZ:0,commonOrigin:!0,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},removeUndefinedProps(t||{})),destroyed:!1,isActive:!1},m=h.params,y=[];!function t(){d=requestAnimationFrame((function(){y.forEach((function(t){if("function"==typeof t)t();else{var e=t.element,o=t.prop,a=t.value;e.style[o]=a}})),y.splice(0,y.length),t()}))}();var g,M=function(t,e){y.push({element:t,prop:"transitionDuration",value:e})},x=function(t,e){y.push({element:t,prop:"transitionTimingFunction",value:e})},w=function(t,e){y.push({element:t,prop:"transform",value:e})},O=function(t,e){y.push({element:t,prop:"opacity",value:e})},_=function(t,e,o,a){return t.addEventListener(e,o,a)},X=function(t,e,o,a){return t.removeEventListener(e,o,a)},Y=function(t){var e=t.rotateXPercentage,o=void 0===e?0:e,a=t.rotateYPercentage,n=void 0===a?0:a,r=t.duration,i=t.opacityOnly,s=t.easeOut;$$(f,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(t){M(t,r),x(t,s?"ease-out":"");var e=function(t){if(t.dataset.atroposOpacity&&"string"==typeof t.dataset.atroposOpacity)return t.dataset.atroposOpacity.split(";").map((function(t){return parseFloat(t)}))}(t);if(0===o&&0===n)i||w(t,"translate3d(0, 0, 0)"),e&&O(t,e[0]);else{var a=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(a)||i||w(t,"translate3d("+-n*-a+"%, "+o*-a+"%, 0)"),e){var p=e[0],c=e[1],u=Math.max(Math.abs(o),Math.abs(n));O(t,p+(c-p)*u/100)}}}))},A=function(t,o){var a=f!==v;if(n||(n=f.getBoundingClientRect()),a&&!r&&(r=v.getBoundingClientRect()),void 0===t&&void 0===o){var i=a?r:n;t=i.left+i.width/2,o=i.top+i.height/2}var p,c=0,u=0,d=n,l=d.top,h=d.left,g=d.width,_=d.height;if(a){var X=r,A=X.top,b=X.left,L=X.width,T=X.height,$=g/2+(h-b),E=_/2+(l-A),R=t-b,P=o-A;u=m.rotateYMax*(R-$)/(L-g/2)*-1,c=m.rotateXMax*(P-E)/(T-_/2),p=t-h+"px "+(o-l)+"px"}else{var I=g/2,D=_/2,F=t-h,j=o-l;u=m.rotateYMax*(F-I)/(g/2)*-1,c=m.rotateXMax*(j-D)/(_/2)}c=Math.min(Math.max(-c,-m.rotateXMax),m.rotateXMax),m.rotateXInvert&&(c=-c),u=Math.min(Math.max(-u,-m.rotateYMax),m.rotateYMax),m.rotateYInvert&&(u=-u);var C,S,k=c/m.rotateXMax*100,q=u/m.rotateYMax*100,N=(a?q/100*m.stretchX:0)*(m.rotateYInvert?-1:1),B=(a?k/100*m.stretchY:0)*(m.rotateXInvert?-1:1),U=a?Math.max(Math.abs(k),Math.abs(q))/100*m.stretchZ:0;w(e,"translate3d("+N+"%, "+-B+"%, "+-U+"px) rotateX("+c+"deg) rotateY("+u+"deg)"),p&&m.commonOrigin&&(C=e,S=p,y.push({element:C,prop:"transformOrigin",value:S})),s&&(M(s,m.duration+"ms"),x(s,"ease-out"),w(s,"translate3d("+.25*-q+"%, "+.25*k+"%, 0)"),O(s,Math.max(Math.abs(k),Math.abs(q))/100)),Y({rotateXPercentage:k,rotateYPercentage:q,duration:m.duration+"ms",easeOut:!0}),"function"==typeof m.onRotate&&m.onRotate(c,u)},b=function(){y.push((function(){return f.classList.add("atropos-active")})),M(e,m.duration+"ms"),x(e,"ease-out"),w(o,"translate3d(0,0, "+m.activeOffset+"px)"),M(o,m.duration+"ms"),x(o,"ease-out"),i&&(M(i,m.duration+"ms"),x(i,"ease-out")),h.isActive=!0},L=function(t){if(p=void 0,!("pointerdown"===t.type&&"mouse"===t.pointerType||"pointerenter"===t.type&&"mouse"!==t.pointerType)){if("pointerdown"===t.type&&t.preventDefault(),c=t.clientX,u=t.clientY,m.alwaysActive)return n=void 0,void(r=void 0);b(),"function"==typeof m.onEnter&&m.onEnter()}},T=function(t){!1===p&&t.cancelable&&t.preventDefault()},E=function(t){if(m.rotate&&h.isActive){if("mouse"!==t.pointerType){if(!m.rotateTouch)return;t.preventDefault()}var e=t.clientX,o=t.clientY,a=e-c,n=o-u;if("string"==typeof m.rotateTouch&&(0!==a||0!==n)&&void 0===p){if(a*a+n*n>=25){var r=180*Math.atan2(Math.abs(n),Math.abs(a))/Math.PI;p="scroll-y"===m.rotateTouch?r>45:90-r>45}!1===p&&(f.classList.add("atropos-rotate-touch"),t.cancelable&&t.preventDefault())}"mouse"!==t.pointerType&&p||A(e,o)}},R=function(t){if(n=void 0,r=void 0,h.isActive&&!(t&&"pointerup"===t.type&&"mouse"===t.pointerType||t&&"pointerleave"===t.type&&"mouse"!==t.pointerType)){if("string"==typeof m.rotateTouch&&p&&f.classList.remove("atropos-rotate-touch"),m.alwaysActive)return A(),"function"==typeof m.onRotate&&m.onRotate(0,0),void("function"==typeof m.onLeave&&m.onLeave());y.push((function(){return f.classList.remove("atropos-active")})),M(o,m.duration+"ms"),x(o,""),w(o,"translate3d(0,0, 0px)"),i&&(M(i,m.duration+"ms"),x(i,"")),s&&(M(s,m.duration+"ms"),x(s,""),w(s,"translate3d(0, 0, 0)"),O(s,0)),M(e,m.duration+"ms"),x(e,""),w(e,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),Y({duration:m.duration+"ms"}),h.isActive=!1,"function"==typeof m.onRotate&&m.onRotate(0,0),"function"==typeof m.onLeave&&m.onLeave()}},P=function(t){var e=t.target;!v.contains(e)&&e!==v&&h.isActive&&R()};return h.destroy=function(){h.destroyed=!0,cancelAnimationFrame(d),X(document,"click",P),X(v,"pointerdown",L),X(v,"pointerenter",L),X(v,"pointermove",E),X(v,"touchmove",T),X(v,"pointerleave",R),X(v,"pointerup",R),X(v,"lostpointercapture",R),delete f.__atropos__},"string"==typeof f&&(f=$(document,f)),f&&(f.__atropos__||(void 0!==v?"string"==typeof v&&(v=$(document,v)):v=f,Object.assign(h,{el:f}),e=$(f,".atropos-rotate"),o=$(f,".atropos-scale"),a=$(f,".atropos-inner"),f.__atropos__=h)),f&&v&&(m.shadow&&((i=$(f,".atropos-shadow"))||((i=document.createElement("span")).classList.add("atropos-shadow"),g=!0),w(i,"translate3d(0,0,-"+m.shadowOffset+"px) scale("+m.shadowScale+")"),g&&e.appendChild(i)),m.highlight&&function(){var t;(s=$(f,".atropos-highlight"))||((s=document.createElement("span")).classList.add("atropos-highlight"),t=!0),w(s,"translate3d(0,0,0)"),t&&a.appendChild(s)}(),m.rotateTouch&&("string"==typeof m.rotateTouch?f.classList.add("atropos-rotate-touch-"+m.rotateTouch):f.classList.add("atropos-rotate-touch")),$(f,"[data-atropos-opacity]")&&Y({opacityOnly:!0}),_(document,"click",P),_(v,"pointerdown",L),_(v,"pointerenter",L),_(v,"pointermove",E),_(v,"touchmove",T),_(v,"pointerleave",R),_(v,"pointerup",R),_(v,"lostpointercapture",R),m.alwaysActive&&(b(),A())),h}export{Atropos,Atropos as default};
//# sourceMappingURL=atropos.esm.browser.min.js.map